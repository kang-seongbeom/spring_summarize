# 6.3 λ‹¤μ΄λ‚΄λ―Ή ν”„λ΅μ‹μ™€ ν©ν† λ¦¬ λΉ

6.3.1 ν”„λ΅μ‹

1. μ „λµ ν¨ν„΄ μ μ©μ„ ν†µν• λ¶€κ°€κΈ°λ¥ κµ¬ν„μ λ¶„λ¦¬
    - λ¶€κ°€μ  κΈ°λ¥μ„ **μ„μ„**μ„ ν†µν•΄ λ¶„λ¦¬
    - κΈ°λ¥μ„ μ‚¬μ©ν•λ” μ½”λ“λ” ν•µμ‹¬ μ½”λ“μ™€ ν•¨κ» λ‚¨μ•„ μμ
    
    ![https://leejaedoo.github.io/assets/img/strategy_pattern.jpeg](https://leejaedoo.github.io/assets/img/strategy_pattern.jpeg)
    
2. λ¶€κ°€κΈ°λ¥κ³Ό ν•µμ‹¬κΈ°λ¥μ λ¶„λ¦¬
    - νΈλμ­μ…μ€ λΉ„μ¦λ‹μ¤ λ΅μ§κ³Ό μ„±κ²©μ΄ λ‹¤λ¥΄κΈ° λ•λ¬Έμ— λ¶„λ¦¬ κ°€λ¥
    - νΈλμ­μ…μ„ UserServiceTxλ΅ λ¶„λ¦¬ν•μ—¬ UserServiceImplμ—λ” λΉ„μ¦λ‹μ¤ λ΅μ§λ§ λ‚¨μ
    
    ![https://leejaedoo.github.io/assets/img/%EB%B6%80%EA%B0%80%EA%B8%B0%EB%8A%A5%EA%B3%BC%ED%95%B5%EC%8B%AC%EA%B8%B0%EB%8A%A5%EC%9D%98%EB%B6%84%EB%A6%AC.jpeg](https://leejaedoo.github.io/assets/img/%EB%B6%80%EA%B0%80%EA%B8%B0%EB%8A%A5%EA%B3%BC%ED%95%B5%EC%8B%AC%EA%B8%B0%EB%8A%A5%EC%9D%98%EB%B6%84%EB%A6%AC.jpeg)
    
3. ν•µμ‹¬κΈ°λ¥ μΈν„°νμ΄μ¤ μ μ©
    - λ¶€κ°€κΈ°λ¥κ³Ό ν•µμ‹¬κΈ°λ¥μ„ **κ°™μ€ μΈν„°νμ΄μ¤**λ¥Ό κµ¬ν„ν•κ² λ§λ“¦
    - ν΄λΌμ΄μ–ΈνΈλ” μΈν„°νμ΄μ¤λ¥Ό ν†µν•΄μ„λ§ ν•µμ‹¬κΈ°λ¥ μ‚¬μ©
    - λ¶€κ°€κΈ°λ¥ μ½”λ“λ¥Ό λ¨Όμ € κ±°μ³ λΉ„μ¦λ‹μ¤ λ΅μ§ λ¶€λ¶„μ„ ν•µμ‹¬κΈ°λ¥μ— **μ„μ„**ν•¨
    - μ‹¤μ  λ€μƒμΈ κ²ƒμ²λΌ **μ„μ¥**ν•΄μ„ ν΄λΌμ΄μ–ΈνΈμ μ”μ²­μ„ λ°›κΈ° λ•λ¬Έμ— **ν”„λ΅μ‹(Proxy)**λΌλ„ λ¶€λ¦„
    
    ![https://leejaedoo.github.io/assets/img/%ED%95%B5%EC%8B%AC%EA%B8%B0%EB%8A%A5_%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4%EC%9D%98%EC%A0%81%EC%9A%A9.jpeg](https://leejaedoo.github.io/assets/img/%ED%95%B5%EC%8B%AC%EA%B8%B0%EB%8A%A5_%EC%9D%B8%ED%84%B0%ED%8E%98%EC%9D%B4%EC%8A%A4%EC%9D%98%EC%A0%81%EC%9A%A9.jpeg)
    

6.3.2 ν”„λ΅μ‹ ν¨ν„΄ μ„¤λ…

- λ¶€κ°€κΈ°λ¥κ³Ό ν•µμ‹¬κΈ°λ¥μ€ κ°™μ€ μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„
- ν”„λ΅μ‹λ¥Ό ν†µν•΄ μµμΆ…μ μΌλ΅ μ”μ²­μ„ μ„μ„λ°›μ•„ μ²λ¦¬ν•λ” μ¤λΈμ νΈλ¥Ό **νƒ€κΉƒ(Target)** or **μ‹¤μ²΄(Real Subject)**λΌκ³  ν•¨
- ν”„λ΅μ‹ μ‚¬μ© λ©μ  λ‘ κ°€μ§€
    1. ν΄λΌμ΄μ–ΈνΈκ°€ νƒ€κΉƒμ— **μ ‘κ·Ό λ°©λ²•** μ μ–΄
    2. νƒ€κΉƒμ— **λ¶€κ°€κΈ°λ¥** λ¶€μ—¬

![https://leejaedoo.github.io/assets/img/%ED%94%84%EB%A1%9D%EC%8B%9C%EC%99%80_%ED%83%80%EA%B9%83.jpeg](https://leejaedoo.github.io/assets/img/%ED%94%84%EB%A1%9D%EC%8B%9C%EC%99%80_%ED%83%80%EA%B9%83.jpeg)

6.3.3 λ°μ½”λ μ΄ν„° ν¨ν„΄ μ„¤λ…

- νƒ€κΉƒμ— **λ¶€κ°€ κΈ°λ¥**μ„ **λ°νƒ€μ„μ‹**μ— λ‹¤μ΄λ‚΄λ―Ήν•κ² λ¶€μ—¬ν•κΈ° μ„ν•΄ **ν”„λ΅μ‹λ¥Ό μ‚¬μ©ν•λ” ν¨ν„΄**
- μ½”λ“μƒμ— μ–΄λ–¤ λ°©λ²•κ³Ό μμ„λ΅ ν”„λ΅μ‹μ™€ νƒ€κΉƒμ΄ μ—°κ²°λμ–΄ μ‚¬μ©λλ”μ§€ μ •ν•΄μ§€μ§€ μ•μ
- μƒλ΅μ΄ κΈ°λ¥μ„ μ¶”κ°€ν•  λ• μ μ©ν•¨
- λ°μ½”λ μ΄ν„° ν¨ν„΄μ€ ν”„λ΅μ‹μ κ°μλ¥Ό μ ν•λ°›μ§€ μ•μ
- λ”°λΌμ„, μ—¬λ¬ λ¶€κ°€ κΈ°λ¥μ„ λ¶€μ—¬ν•  μ μμ
- λ°μ½”λ μ΄ν„°λ” μ„μ„ν•λ” λ€μƒμ—λ„ μΈν„°νμ΄μ¤λ΅ μ ‘κ·Όν•κΈ° λ•λ¬Έμ— λ°νƒ€μ„μ‹ μ£Όμ…λ°›μ„ μ μμ

![https://leejaedoo.github.io/assets/img/%EB%8D%B0%EC%BD%94%EB%A0%88%EC%9D%B4%ED%84%B0_%ED%8C%A8%ED%84%B4.jpeg](https://leejaedoo.github.io/assets/img/%EB%8D%B0%EC%BD%94%EB%A0%88%EC%9D%B4%ED%84%B0_%ED%8C%A8%ED%84%B4.jpeg)

- InputStream κµ¬ν„ ν΄λμ¤λ” λ°μ½”λ μ΄ν„° ν¨ν„΄μ΄ μ‚¬μ©λ λ€ν‘μ μΈ μμ‹μ„
- InputStreamμ„ κµ¬ν„ν•λ” FileInputStreamμ— λ²„νΌ μ½κΈ° κΈ°λ¥μ„ μ κ³µν•λ” BufferedInputStreamμ΄λΌλ” λ°μ½”λ μ΄ν„°λ¥Ό μ μ©ν• μμ‹μ„
    
    ```java
    //InputStream : μΈν„°νμ΄μ¤ 
    //FileInputStream : νƒ€κΉƒ
    //BufferedInputStream : λ°μ½”λ μ΄ν„°
    InputStream is = new BufferedInputStream(new FileInputStream("a.txt"));
    ```
    
- μΈν„°νμ΄μ¤λ¥Ό ν†µν• λ°μ½”ν…μ΄ν„° μ •μμ™€ μ£Όμ…μ€ μ¤ν”„λ§μ DI λ°©μ‹μ„ μ΄μ©ν•λ©΄ νΈλ¦¬ν•¨
- UserServiceTx ν΄λμ¤λ΅ μ„ μ–Έ λ UserService λΉμ€ λ°μ½”λ μ΄ν„°μ„
- UserServiceTxλ” UserService νƒ€μ…μ μ¤λΈμ νΈλ¥Ό DI λ°›μ•„ λΉ„μ¦λ‹μ¤ κΈ°λ¥μ€ μ„μ„ν•μ§€λ§, κ·Έ κ³Όμ •μ—μ„ νΈλμ­μ… κ²½κ³„μ„¤μ • κΈ°λ¥μ„ λ¶€μ—¬ν•¨
    
    ```xml
    <beans 
    		.../>
    		<!--λ°μ½”λ μ΄ν„°-->
        <bean id="userService" class="com.ksb.spring.UserServiceTx">
            <property name="transactionManager" ref="transactionManager"/>
            <property name="userService" ref="userServiceImpl"/>
        </bean>
    		
    		<!--νƒ€κΉƒ-->
        <bean id="userServiceImpl" class="com.ksb.spring.UserServiceImpl">
            <property name="userDao" ref="userDao"/>
            <property name="mailSender" ref="mailSender"/>
        </bean>
    <beans/>
    ```
    

6.3.4 ν”„λ΅μ‹ ν¨ν„΄

- μΌλ°μ μΌλ΅ μ‚¬μ©ν•λ” **ν”„λ΅μ‹**μ™€ **ν”„λ΅μ‹ ν¨ν„΄**μ€ κµ¬λ¶„ν•  ν•„μ”κ°€ μμ
- μΌλ°μ  ν”„λ΅μ‹λ” ν΄λΌμ΄μ–ΈνΈμ™€ μ‚¬μ©μ μ‚¬μ΄μ λ€λ¦¬μΈ μ—­ν• 
- ν”„λ΅μ‹ ν¨ν„΄μ€ νƒ€κΉƒμ— λ€ν• **μ ‘κ·Ό λ°©λ²•**μ„ μ μ–΄
- νƒ€κΉƒμ κΈ°λ¥μ„ ν™•μ¥ λ° μ¶”κ°€λ¥Ό ν•μ§€ μ•μ§€λ§, ν΄λΌμ΄μ–ΈνΈκ°€ νƒ€κΉƒμ— μ ‘κ·Όν•λ” λ°©μ‹μ„ λ³€κ²½ν•¨
- ν΄λΌμ΄μ–ΈνΈκ°€ νƒ€κΉƒμ„ μ‚¬μ©ν•  λ•, ν”„λ΅μ‹κ°€ νƒ€κΉƒ μ¤λΈμ νΈλ¥Ό μƒμ„±ν•κ³  μ”μ²­μ„ μ„μ„ν•¨
- λ‹¤λ¥Έ μ„λ²„μ μ¤λΈμ νΈλ¥Ό μ‚¬μ©ν•  λ• ν”„λ΅μ‹ ν¨ν„΄ μ‚¬μ©
- μ›κ²© μ¤λΈμ νΈμ— λ€ν• ν”„λ΅μ‹λ¥Ό λ§λ“¤μ–΄λ‘κ³ , ν΄λΌμ΄μ–ΈνΈλ” λ§μΉ λ΅μ»¬μ— μ΅΄μ¬ν•λ” μ¤λΈμ νΈλ¥Ό μ“°λ” κ²ƒ μ²λΌ ν”„λ΅μ‹λ¥Ό μ‚¬μ©ν•  μ μμ
    
    <aside>
    π’΅ μ΄μ λ” ν”„λ΅μ‹μ™€ μ›κ²© μ¤λΈμ νΈλ” κ°™μ€ μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•κΈ° λ•λ¬Έμ„
    
    </aside>
    
- λλ”, νΉλ³„ν• μƒν™©μ—μ„ νƒ€ν‚·μ— λ€ν• μ ‘κ·Όκ¶ν•μ„ μ μ–΄ν•κΈ° μ°ν•΄ ν”„λ΅μ‹ ν¨ν„΄ μ‚¬μ©
- ν”„λ΅μ‹λ¥Ό κ±°μΉκ² ν•μ—¬ νΉμ • λ©”μ†λ“λ¥Ό μ‚¬μ©ν•λ ¤κ³  ν•  λ•, μμ™Έλ¥Ό λμ Έ λ§‰μ„ μ μμ
- κµ¬μ΅°μ μΌλ΅ ν”„λ΅μ‹μ™€ λ°μ½”λ μ΄ν„°λ” μ μ‚¬ν•¨
- λ‹¤λ§, ν”„λ΅μ‹λ” μ½”λ“μ—μ„ μμ‹ μ΄ λ§λ“¤κ±°λ‚ μ ‘κ·Όν•  νƒ€κΉƒ ν΄λμ¤μ μ •λ³΄λ¥Ό μ•„λ” κ²½μ°κ°€ λ§μ. ν•μ§€λ§, ν”„λ΅μ‹ ν¨ν„΄μ΄λΌλ„ μΈν„°νμ΄μ¤λ¥Ό ν†µν•΄ μ„μ„ν•κ² ν•  μ μμ

![https://leejaedoo.github.io/assets/img/proxy_decorator.jpeg](https://leejaedoo.github.io/assets/img/proxy_decorator.jpeg)

- μ•μΌλ΅ νƒ€κΉƒκ³Ό **λ™μΌν• μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„**ν•κ³ , ν΄λΌμ΄μ–ΈνΈμ™€ νƒ€κΉƒ **μ‚¬μ΄μ— μ΅΄μ¬**ν•λ©°, **λ¶€κ°€ λλ” μ ‘κ·Ό μ μ–΄λ¥Ό λ‹΄λ‹Ή**ν•λ” μ¤λΈμ νΈλ¥Ό λ¨λ‘ **ν”„λ΅μ‹**λΌ ν•κ² μ

6.3.5 ν”„λ΅μ‹ ν¨ν„΄μ λ¬Έμ μ 

- ν”„λ΅μ‹λ” κΈ°μ΅΄ μ½”λ“μ— μν–¥μ„ μ£Όμ§€ μ•κ³ , νƒ€κΉƒμ κΈ°λ¥ ν™•μ¥ λλ” μ ‘κ·Ό λ°©λ²•μ„ μ μ–΄ν•  μ μλ” μ μ©ν• λ°©λ²•μ„
- ν•μ§€λ§, λ§¤λ² μƒλ΅μ΄ ν΄λμ¤λ¥Ό μ •μν•΄μ•Ό ν•¨
- λν•, μΈν„°νμ΄μ¤μ— κµ¬ν„ν•΄μ•Ό ν•λ” λ©”μ†λ“κ°€ λ§μ„ κ²½μ° μΌμΌμ΄ λ¨λ“  λ©”μ†λ“λ¥Ό κµ¬ν„ν•΄μ•Ό ν•¨
- UserServiceTxμ—μ„ νΈλμ­μ…μ΄λΌλ” λ¶€κ°€κΈ°λ¥μ„ μν–‰ν•κ³ , λΉ„μ¦λ‹μ¤λ΅μ§μ€ UserServiceImplμ— μ„μ„ν•¨
- λ¶€κ°€κΈ°λ¥ μ‚¬μ΄μ— μ„μ„ν•λ” λ¶€λ¶„μ΄ μ΅΄μ¬ν•κΈ° λ•λ¬Έμ—, λ¶€κ°€κΈ°λ¥μ„ μ¬ν™μ©ν•λ” κ²ƒμ΄ μ–΄λ ¤μ›€
- λ•λ¬Έμ—, λ‹¤λ¥Έ λ©”μ†λ“μ—μ„ λ™μΌν• νΈλμ­μ… λ¶€κ°€κΈ°λ¥μ„ ν•„μ”ν•λ©΄ λ‘κ°™μ΄ κµ¬ν„ν•΄μ•Ό ν•΄μ„ μ½”λ“ μ¤‘λ³µμ΄ λ°μƒν•¨
- λ© ν”„λ μ„μ›ν¬ μ²λΌ `java.lang.reflect` ν¨ν‚¤μ§€ μ•μ— ν”„λ΅μ‹λ¥Ό μ‰½κ² λ§λ“¤λ„λ΅ ν•λ” ν΄λμ¤λ“¤μ΄ μμ

6.3.6 λ¦¬ν”λ ‰μ…

- **λ‹¤μ΄λ‚΄λ―Ή ν”„λ΅μ‹**λ” λ¦¬ν”λ ‰μ… κΈ°λ¥μ„ μ΄μ©ν•΄μ„ ν”„λ΅μ‹λ¥Ό λ§λ“¤μ–΄μ¤
- λ¦¬ν”λ ‰μ…μ€ μλ°”μ μ½”λ“ μμ²΄λ¥Ό μ¶”μƒν™”ν•΄μ„ μ ‘κ·Όν•λ„λ΅ λ§λ“ κ²ƒμ„
- μλ°”μ λ¨λ“  ν΄λμ¤λ” ν΄λμ¤ μμ²΄μ— κµ¬μ„±μ •λ³΄λ¥Ό λ‹΄μ€ Class νƒ€μ…μ μ¤λΈμ νΈλ¥Ό ν•λ‚μ”© κ°€μ§€κ³  μμ
- β€ν΄λμ¤μ΄λ¦„.classβ€ λλ” getClass()λ¥Ό ν†µν•΄ Class νƒ€μ…μ μ¤λΈμ νΈλ¥Ό κ°€μ Έμ¬ μ μμ
- ν΄λμ¤ μ¤λΈμ νΈλ¥Ό μ΄μ©ν•λ©΄ ν΄λμ¤ μ½”λ“μ— λ€ν• **λ©”νƒ€μ •λ³΄**λ¥Ό κ°€μ Έμ¤κ±°λ‚ μ¤λΈμ νΈλ¥Ό **μ΅°μ‘**ν•  μ μμ
- ν΄λμ¤ μ΄λ¦„, μƒμ†ν• ν΄λμ¤, νƒ€μ…, ν•„λ“ λ“±μ μ •λ³΄λ¥Ό μ• μ μμ
- λ¦¬ν”λ ‰μ… API μ¤‘μ—μ„ **λ©”μ†λ“**μ— λ€ν• μ •μλ¥Ό λ‹΄μ€ **Method μΈν„°νμ΄μ¤**λ¥Ό μ΄μ©ν•λ©΄ λ©”μ†λ“λ¥Ό νΈμ¶ν•  μ μμ

6.3.7 Method μΈν„°νμ΄μ¤

- λ©”μ†λ“μ— λ€ν• μμ„Έν• μ •λ³΄λ¥Ό λ‹΄κ³  μμ
- μ¤νΈλ§μ΄ κ°€μ§„ λ©”μ†λ“ μ¤‘μ—μ„  β€lengthβ€λΌλ” μ΄λ¦„μ„ κ°–κ³  μκ³ , νλΌλ―Έν„°κ°€ μ—†λ” λ©”μ†λ“ μ •λ³΄λ¥Ό κ°€μ Έμ¤λ” μ½”λ“λ” λ‹¤μκ³Ό κ°™μ
    
    ```java
    Method lengthMethod = String.class.getMethod("length");
    ```
    
- νΉμ • μ¤λΈμ νΈμ λ©”μ†λ“λ¥Ό μ‹¤ν–‰ν•  μ μμ
- Method μΈν„°νμ΄μ¤μ— μ •μλ invoke()λ¥Ό μ‚¬μ©ν•λ©΄ λ¨
- invoke()λ” λ©”μ†λ“λ¥Ό μ‹¤ν–‰μ‹ν‚¬ λ€μƒ μ¤λΈμ νΈ(obj)μ™€ νλΌλ―Έν„° λ©λ΅(args)λ¥Ό λ°›μ•„ λ©”μ†λ“λ¥Ό νΈμ¶ν• λ’¤μ— κ·Έ κ²°κ³Όλ¥Ό Object νƒ€μ…μΌλ΅ λλ ¤μ¤
    
    ```java
    public Object invoke(Object obj, Object... args)
    
    int length = lengthMethod.invoke(name) // int length = name.length();
    ```
    

```java
public class ReflectionTest {
    @Test
    public void invokeMethod() throws Exception {
        String name = "Spring";

        //length()
        assertThat(name.length(), is(6));

        Method lengthMethod = String.class.getMethod("length");
        assertThat((Integer)lengthMethod.invoke(name), is(6));

        //charAt()
        assertThat(name.charAt(0), is('S'));

        Method charAtMethod = String.class.getMethod("charAt", int.class);
        assertThat((Character)charAtMethod.invoke(name, 0), is('S'));
    }
}
```

6.3.8 ν”„λ΅μ‹ ν΄λμ¤

- ν”„λ΅μ‹λ¥Ό μ μ©ν•  κ°„λ‹¨ν• νƒ€ν‚· ν΄λμ¤μ™€ μΈν„°νμ΄μ¤λ¥Ό λ§λ“¤κ²ƒμ„
- ν•΄λ‹Ή μ½”λ“λ” μΈν„°νμ΄μ¤μ λ¨λ“  λ©”μ†λ“ κµ¬ν„ λ° μ„μ„κ³Ό, λ¶€κ°€κΈ°λ¥μ΄ λ¨λ“  λ©”μ†λ“μ— μ¤‘λ³µλΌμ„ λ‚νƒ€λ‚¨
- μ¦‰, ν”„λ΅μ‹ μ μ©μ μΌλ°μ μΈ λ‘ κ°€μ§€μ λ¬Έμ μ  λ¨λ‘ λ³΄μ 

```java
public interface Hello {
    String sayHello(String name);
    String sayHi(String name);
    String sayThankYou(String name);
}

public class HelloTarget implements Hello{
    @Override
    public String sayHello(String name) {
        return "Hello "+name;
    }

    @Override
    public String sayHi(String name) {
        return "Hi "+name;
    }

    @Override
    public String sayThankYou(String name) {
        return "Thank You "+name;
    }
}

public class HelloUppercase implements Hello {
    Hello hello;

    public HelloUppercase(Hello hello) {
        this.hello = hello;
    }

    //toUpperCase()κ°€ λ¨λ“  λ©”μ†λ“μ—μ„ μ¤‘λ³µ. μ¦‰, λ¶€κ°€κΈ°λ¥μ΄ μ¤‘λ³µλ¨
    @Override
    public String sayHello(String name) {
        return this.hello.sayHello(name).toUpperCase();
    }

    @Override
    public String sayHi(String name) {
        return this.hello.sayHi(name).toUpperCase();
    }

    @Override
    public String sayThankYou(String name) {
        return this.hello.sayThankYou(name).toUpperCase();
    }
}

public class ReflectionTest {
		...
		@Test
    public void simpleProxy(){
        Hello hello = new HelloTarget();
        assertThat(hello.sayHello("Toby"), is("Hello Toby"));
        assertThat(hello.sayHi("Toby"), is("Hi Toby"));
        assertThat(hello.sayThankYou("Toby"), is("Thank You Toby"));
			
				//ν”„λ΅μ‹λ¥Ό ν†µν• νƒ€κΉƒ μ ‘κ·Ό
        Hello proxiedHello = new HelloUppercase(new HelloTarget());
        assertThat(proxiedHello.sayHello("Toby"), is("HELLO TOBY"));
        assertThat(proxiedHello.sayHi("Toby"), is("HI TOBY"));
        assertThat(proxiedHello.sayThankYou("Toby"), is("THANK YOU TOBY"));

    }
}
```

6.3.9 λ‹¤μ΄λ‚΄λ―Ή ν”„λ΅μ‹

- λ‹¤μ΄λ‚΄λ―Ή ν”„λ΅μ‹λ” **ν”„λ΅μ‹ ν©ν† λ¦¬**μ— μν•΄ λ°νƒ€μ„ μ‹ λ‹¤μ΄λ‚΄λ―Ήν•κ² λ§λ“¤μ–΄μ§€λ” **μ¤λΈμ νΈ**
- λ‹¤μ΄λ‚΄λ―Ή ν”„λ΅μ‹λ” κΈ°μ΅΄μ ν”„λ΅μ‹μ²λΌ νƒ€κΉƒμ μΈν„°νμ΄μ¤μ™€ **λ™μΌν• μΈν„°νμ΄μ¤ κµ¬ν„**
- ν”„λ΅μ‹ ν©ν† λ¦¬μ—κ² μΈν„°νμ΄μ¤ μ •λ³΄λ§ μ κ³µν•λ©΄ ν•΄λ‹Ή μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν• ν΄λμ¤μ μ¤λΈμ νΈ μλ™ μƒμ„±ν•¨
    
    ![https://leejaedoo.github.io/assets/img/dynamic_proxy.jpeg](https://leejaedoo.github.io/assets/img/dynamic_proxy.jpeg)
    
- λ¶€κ°€κΈ°λ¥μ€ `InvocationHandler`λ¥Ό κµ¬ν„ν• μ¤λΈμ νΈμ—μ„ μ§μ ‘ μ‘μ„±ν•¨
- `InvocationHandler`λ” invoke() λ©”μ†λ“λ§ κ°€μ§€λ” μΈν„°νμ΄μ¤μ„
- invoke()λ” λ¦¬ν”λ ‰μ…μ Method μΈν„°νμ΄μ¤λ¥Ό **νλΌλ―Έν„°**λ΅ λ°›μ
- λ‹¤μ΄λ‚΄λ―Ή ν”„λ΅μ‹ μ¤λΈμ νΈλ” ν΄λΌμ΄μ–ΈνΈμ **λ¨λ“  μ”μ²­**μ„ λ¦¬ν”λ ‰μ… μ •λ³΄λ΅ **λ³€ν™**ν•΄μ„ invoke() λ©”μ†λ“μ— μ „λ‹¬
- λ¨λ“  μ”μ²­μ΄ invoke()λ΅ μ§‘μ¤‘λκΈ° λ•λ¬Έμ— **μ¤‘λ³µλλ” κΈ°λ¥ ν¨κ³Όμ  μ κ³µ**κ°€λ¥
    
    ![https://leejaedoo.github.io/assets/img/invocationHandler.jpeg](https://leejaedoo.github.io/assets/img/invocationHandler.jpeg)
    
- λ¦¬ν”λ™μ…μ€ Methodμ™€ νλΌλ―Έν„° μ •λ³΄κ°€ μμΌλ©΄ λ©”μ†λ“λ¥Ό νΈμ¶ν•  μ μμ
    
    ```java
    Method charAtMethod = String.class.getMethod("charAt", int.class);
    assertThat((Character)charAtMethod.invoke(name, 0), is('S'));
    ```
    
- λ¦¬ν”λ ‰μ…μ—λ” λ©”μ†λ“μ™€ νλΌλ―Έν„° μ •λ³΄(λ©”νƒ€μ •λ³΄)λ¥Ό λ¨λ‘ κ°–κΈ°μκΈ° λ•λ¬Έμ— νƒ€κΉƒ μ¤λΈμ νΈμ΄ λ©”μ†λ“ νΈμ¶ κ°€λ¥
- μ¦‰, `InvocationHandler`κµ¬ν„ μ¤λΈμ νΈκ°€ νƒ€κΉƒ μ¤λΈμ νΈ λ νΌλ°μ¤λ¥Ό κ°€μ§€κ³  μμΌλ©΄ λ¦¬ν”λ ‰μ…μΌλ΅ κ°„λ‹¨ν μ„μ„ μ½”λ“λ¥Ό λ§λ“¤μ μμ

6.3.10 λ‹¤μ΄λ‚΄λ―Ή ν”„λ΅μ‹ μ μ©

- λ‹¤μ΄λ‚΄λ―Ή ν”„λ΅μ‹λ΅λ¶€ν„° μ”μ²­μ„ μ „λ‹¬λ°›μΌλ ¤λ©΄ `InvocationHandler`λ¥Ό κµ¬ν„ ν•΄μ•Όν•¨
- λ©”μ†λ“λ” invoke() ν•λ‚ λΏμ„
- ν”„λ΅μ‹κ°€ μ κ³µν•λ ¤λ” λ¶€κ°€κΈ°λ¥μΈ λ¦¬ν„΄ κ°’μ„ λ€λ¬Έμ λ³€κ²½
- λ‹¤μ΄λ‚΄λ―Ή ν”„λ΅μ‹ μƒμ„±μ€ Proxy ν΄λμ¤μ newProxyInstance() μ¤νƒν”½ ν©ν† λ¦¬ λ©”μ†λ“λ¥Ό μ‚¬μ©ν•λ©΄ λ¨
    - μ²« λ²μ§Έ νλΌλ―Έν„°λ” ν΄λμ¤ λ΅λ” μ κ³µ
    - λ‘ λ²μ§Έ νλΌλ―Έν„°λ” ν”„λ΅μ‹κ°€ κµ¬ν„ν•΄μ•Ό ν•  μΈν„°νμ΄μ¤. λ‹¤μ΄λ‚΄λ―Ή ν”„λ΅μ‹λ” ν• λ²μ— ν•λ‚ μ΄μƒμ μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν•  μ μμ–΄ λ°°μ—΄ μ‚¬μ©
    - μ„Έ λ²μ§Έ νλΌλ―Έν„°λ” `InvocationHandler` κµ¬ν„ μ¤λΈμ νΈ

```java
public class UppercaseHandler implements InvocationHandler {
    Hello target;

    public UppercaseHandler(Hello target) {
        this.target = target;
    }

    @Override
    public Object invoke(Object proxy, Method method, Object[] args)
            throws Throwable {
        String ret = (String)method.invoke(target, args);
        return ret.toUpperCase(); //λ¶€κ°€κΈ°λ¥
    }
}

public class ReflectionTest {
		@Test
    public void simpleProxy(){
        ...
        //ν”„λ΅μ‹λ¥Ό ν†µν• νƒ€κΉƒ μ ‘κ·Ό
        Hello proxiedHello = (Hello) Proxy.newProxyInstance(
                getClass().getClassLoader(),
                new Class[] {Hello.class},
                new UppercaseHandler(new HelloTarget())
        );
        assertThat(proxiedHello.sayHello("Toby"), is("HELLO TOBY"));
        assertThat(proxiedHello.sayHi("Toby"), is("HI TOBY"));
        assertThat(proxiedHello.sayThankYou("Toby"), is("THANK YOU TOBY"));
    }
}
```

6.3.11 λ‹¤μ΄λ‚΄λ―Ή ν”„λ΅μ‹μ ν™•μ¥

- λ‹¤μ΄λ‚΄λ―Ή ν”„λ΅μ‹λ¥Ό μ‚¬μ©ν•¨μΌλ΅μ¨ μΈν„°νμ΄μ¤μ λ¨λ“  λ©”μ†λ“λ¥Ό κµ¬ν„μ•ν•΄λ„ λ¨
- λ‹¤μ΄λ‚΄λ―Ή ν”„λ΅μ‹κ°€ λ§λ“¤μ–΄μ§ λ• μΈν„°νμ΄μ¤μ λ©”μ†λ“κ°€ μλ™μ μΌλ΅ μ¶”κ°€λκ³ , λ¶€κ°€κΈ°λ¥μ€ invoke()μ—μ„ μ²λ¦¬λ¨
- `UppercaseHandler`λ” λ¨λ“  λ©”μ†λ“μ λ¦¬ν„΄ νƒ€μ…μ΄ μ¤νΈλ§μ΄λΌ κ°€μ •ν•κ³  μμ
- λ§μ•½ μ¤νΈλ§μ΄ μ•„λ‹ λ¦¬ν„΄νƒ€μ…μ„ κ°–λ” λ©”μ†λ“κ°€ μ¶”κ°€λλ©΄ λ°νƒ€μ„ μ‹ μΊμ¤ν… μ¤λ¥κ°€ λ°μƒ
- λ¦¬ν”λ ‰μ…μ€ λ§¤μ° μ μ—°ν•κ³  λ§‰κ°•ν•΄ μ£Όμ κΉκ² μ‚¬μ©ν•΄μ•Ό ν•¨
- λ”°λΌμ„, Methodλ¥Ό μ΄μ©ν• νƒ€κΉƒ μ¤λΈμ νΈμ λ©”μ†λ“ νΈμ¶ν›„ λ¦¬ν„΄νƒ€μ…μ„ ν™•μΈν•λ” μ‘μ—… ν•„μ”
- λν•, `InvocationHandler` λ” νƒ€κΉƒμ μΆ…λ¥ μƒκ΄€μ—†μ΄ μ μ© κ°€λ¥ν•¨
- μ–΄μ©ν”Ό λ¦¬ν”λ ‰μ…μ Method μΈν„°νμ΄μ¤λ¥Ό μ΄μ©ν•΄ νƒ€κΉƒ λ©”μ†λ“λ¥Ό νΈμ¶ν•κΈ° λ•λ¬Έμ„
- μ¦‰, νƒ€κΉƒμ νƒ€μ…μ„ Helloκ°€ μ•„λ‹ Objectλ΅ μ§€μ •ν•΄λ„ λ¨

```java
public class UppercaseHandler implements InvocationHandler {
    Object target;

    public UppercaseHandler(Object target) {
        this.target = target;
    }

    @Override
    public Object invoke(Object proxy, Method method, Object[] args)
            throws Throwable {
        Object ret = method.invoke(target, args);
        if(ret instanceof String)
            return (String)((String) ret).toUpperCase();
        else
            return ret;
    }
}
```

- λ¦¬ν„΄ νƒ€μ… λΏλ§μ΄ μ•„λ‹λΌ, λ©”μ†λ“ μ΄λ¦„μΌλ΅ μ΅°κ±΄μ„ κ±Έ μ μμ
- Method νλΌλ―Έν„°μ—μ„ λ©”μ†λ“ μ΄λ¦„μ„ κ°€μ Έμ™€ ν™•μΈν•λ©΄ λ¨

```java
public class UppercaseHandler implements InvocationHandler {
    ...
    @Override
    public Object invoke(Object proxy, Method method, Object[] args)
            throws Throwable {
        Object ret = method.invoke(target, args);
        if(ret instanceof String && 
                method.getName().startsWith("say"))
            return (String)((String) ret).toUpperCase();
        else
            return ret;
    }
}
```